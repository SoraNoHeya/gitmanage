# 实验

## 会议管理

### 用例图

![会议管理](会议管理.png)

### 用例规约

| 用例名称   | 查询预定情况                                   |
| ------ | ---------------------------------------- |
| 参与者    | 任意用户                                     |
| 用例简述   | 用户可以通过该用例查询会议室的预定情况                      |
| 前置条件   | 用户能够访问系统                                 |
| 后置条件   | 返回查询结果                                   |
| 基本事件流  | 1. 用户发出查询请求<br />2. 系统返回查询结果<br />3. 此用例成功结束 |
| 备选事件流  | 无                                        |
| 非功能性需求 | 1. 所有请求和返回都通过https加密传输，保证安全性             |

| 用例名称   | 申请使用会议室                                  |
| ------ | ---------------------------------------- |
| 参与者    | 会议室用户                                    |
| 用例简述   | 用户可以通过该用例申请使用会议室                         |
| 前置条件   | 用户能够访问系统                                 |
| 后置条件   | 返回申请发送状态                                 |
| 基本事件流  | 1. 用户发出申请请求<br />2. 管理员判定用户所请求会议室是否可以使用<br />3. 系统返回申请成功<br />4. 此用例成功结束 |
| 备选事件流  | 无                                        |
| 非功能性需求 | 1. 所有请求和返回都通过https加密传输，保证安全性             |

| 用例名称   | 审核使用申请                                   |
| ------ | ---------------------------------------- |
| 参与者    | 会议室管理员                                   |
| 用例简述   | 会议室管理员可以通过该用例审核用户使用申请                    |
| 前置条件   | 用户已发出申请请求，管理员可以访问系统                      |
| 后置条件   | 1. 用例成功结束<br />1.1 返回审核结果<br />2. 用例失败结束<br />2.1 返回失败原因 |
| 基本事件流  | 1. 管理员审核用户请求<br />2. 系统返回审核结果<br />3. 此用例成功结束 |
| 备选事件流  | 1. 若系统发现会议室已被占用<br />1.1 此用例失败结束         |
| 非功能性需求 | 1. 所有请求和返回都通过https加密传输，保证安全性             |

### 服务描述

### 接口设计

+ 查询请求

  + token
    + 用户所使用的id
  + roomId
    + 用户查询的房间号

   ```http
  GET /room/query?token=123&roomId=1234 HTTP/1.1
   ```

  + id
    + 申请的Id
  + schedule
    + 房间的占用预定列表
  + from
    + 占用时间区间开头
  + to
    + 占用时间区间结尾
  + user
    + 用户的id

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/vnd.api+json

  {
    "schedule": [
      {
        "id": 1,
        "from": 10000,
        "to": 20000,
        "user": "userId"
      }
    ]
  }
  ```

+ 申请使用

  + token
    + 用户所使用的Id
  + roomId
    + 预定的房间号
  + from
    + 预定的开始时间
  + to
    + 预定的结束时间

  ```http
  POST /room/register HTTP/1.1
  Content-Type: application/x-www-form-urlencoded

  token=&roomId=&from=&to=
  ```

  + id
    + 申请的id号
  + state
    + 申请成功发送时返回0，其余为1
  + msg
    + 对于申请的其他详细描述

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/vnd.api+json

  {
    "id": 1
    "state": 0,
    "msg": ""
  }
  ```

+ 获取申请列表

  + token
    + 用户id

  ```http
  GET /room/register?token=123 HTTP/1.1
  ```

  + register
    + 申请列表
  + id
    + 申请id
  + room
    + 申请的房间号
  + from
    + 申请使用时间区间开始
  + to
    + 申请使用时间区间结束
  + user
    + 申请人id

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/vnd.api+json

  {
    "register": [
      {
        "id": 1,
        "room": 123,
        "from": 100000,
        "to": 200000,
        "user": 3333
      }
    ]
  }
  ```


+ 审核申请

  + token
    + 用户id
  + id
    + 申请id
  + action
    + 审核结果，0代表通过，1代表拒绝

  ```http
  POST /room/register HTTP/1.1
  Content-Type: application/x-www-form-urlencoded

  token=&id=&action=
  ```

  + state
    + 审核状态，0代表审核成功提交，否则为1
  + msg
    + 详细信息

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/vnd.api+json

  {
    "state": 0,
    "msg": "success"
  }
  ```

  ​

## 权限管理

### 用例图

![权限管理](权限管理.PNG)

### 用例规约

| 用例名称   | 判断权限是否满足                                 |
| ------ | ---------------------------------------- |
| 参与者    | 任意用户                                     |
| 用例简述   | 该用例规定了用户判断是否有相应的权限完成某项操作                 |
| 前置条件   | 当任意用户发出某项操作时，系统会自动调用权限管理服务，判断权限是否满足      |
| 后置条件   | 若权限满足，则执行相应的服务，否则，返回权限错误提示               |
| 基本事件流  | 1. 用户发出人已请求<br />2. 系统自动将请求拦截，并使用权限管理服务的权限判断<br />3. 权限管理服务再将请求的信息发向其他目标服务<br />4. 此用例成功结束 |
| 备选事件流  | 1. 如果在基本事件流步骤 2 中权限判断不满足<br />1.1 返回错误提示，并抛弃这次请求<br />1.2 此用户成功结束 |
| 发生频率   | 每次用户提交一项请求，都会进行权限判断                      |
| 非功能性需求 | 1. 有强大的高并发处理能力，每秒至少能处理 10000 条权限判断请求     |

| 用例名称   | 分配权限                                     |
| ------ | ---------------------------------------- |
| 参与者    | 权限管理员、被分配权限的用户                           |
| 用例简述   | 该用例规定了权限管理员对其他用户进行响应权限的分配，让其他用户拥有某项操作的权限 |
| 前置条件   | 分配管理员需要有分配权限的权限                          |
| 后置条件   | 被分配权限的用户获得某项操作的权限                        |
| 基本事件流  | 1. 权限管理员发起为某用户分配权限的请求<br />2. 被分配权限的用户获得某项操作的权限<br /> |
| 备选事件流  | 1. 如果在基本事件流步骤 2 中被分配权限的用户已有响应权限<br />1.1 直接返回，不需要再进行分配操作 |
| 发生频率   | 每次用户权限管理员对其他用户进行响应权限的分配，都会进行权限分配         |
| 非功能性需求 | 1. 有强大的高并发处理能力，每秒至少能处理 10000 条权限分配请求     |

### 服务描述

本系统的每位用户

### 接口设计

+ 判权请求

  + userid
    + 用户所使用的id
  + action
    + 用户所请求的操作

   ```http
  GET /auth?token=${userid}&action=${action} HTTP/1.1
   ```

  + state
    + 授权成功该接口不返回，失败时为1
  + msg
    + 授权失败的描述

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/vnd.api+json

  {
    "state": 1,
    "msg": "No permission."
  }
  ```

